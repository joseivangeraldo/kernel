video from https://www.youtube.com/watch?v=8rncBCVySEw&t=1197s

Low Level programming language
Comunicate with microprocessor

INSTALANDO PROGRAMAS NECESSARIOS:
    $ sudo apt install nasm build-essential
    AGORA TEMOS NASM E LD INSTALADOS.
LINK CONSULTA:
https://shell-storm.org/
https://shell-storm.org/shellcode/files/shellcode-78.php

$ nasm -f elf64 demo.asm -o demo.o
$ ld demo.o -o demo
ld: warning: cannot find entry symbol _start; defaulting to 0000000000401000

$ sudo apt install net-tools --> para usar o comando netstat

$ netstat -nlt
tcp        0      0 0.0.0.0:4444            0.0.0.0:*               LISTEN     

sudo apt install netcat-traditional  --> para INSTALAR PACOTE NC - Network connect
$ nc localhost 4444

EXIBIR O ARQUIVO OBJEO EM CODIGO FONTE:
$ objdump -D -M intel demo.o

EXTRACTING CPU INFORMATION:
INTEL - ARM - MIPS
$ lscpu

$ cat /proc/cpuinfo
Important in the combo flags have the itens: mmx , lm

GDB YOUR BEST FRIEND:
$ gdb
(gdb) 

$ make test_gdb
$ pico test_gdb.c --> abre este editor
gitpod /workspace/kernel/pentesteracadem (main) $ gdb ./gdb_test
(gdb) run hello
(gdb) run PentesterAcademyPass

SOLUTION FROM GDB PROBLEM:
$ gdb -q gdb_test
(No debugging symbols found in gdb_test)
SOLUÇÃO RECOMPILAR NOVAMENTE COM SIMBOLOS GDB:
$ gcc -ggdb gdb_test.c -o gdb_test
APÓS FICA ASSIM:
Reading symbols from gdb_test...
(gdb) list --> exibe o codigo fonte

gitpod /workspace/kernel/pentesteracadem (main) $ gdb -q gdb_test
Reading symbols from gdb_test...
(gdb) list
1       #include<stdio.h>
2       #include<string.h>
3
4       int main(int argc, char **argv)
5       {
6           char *p = "PentesterAcademyPass";
7
8           if (strcmp(argv[1], p) == 0)
9           {
10              printf("\nWelcome to the SLAE 64-bit course! Please proceed to the next video!\n");
(gdb) 
11          }
12          else
13          {
14              printf("\nTime to review those GDB videos again!\n");
15          }
16          return 0;
17      }
(gdb) break 8
Breakpoint 1 at 0x1187: file gdb_test.c, line 8.
(gdb) run hello
Starting program: /workspace/kernel/pentesteracadem/gdb_test hello
warning: Error disabling address space randomization: Operation not permitted
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

Breakpoint 1, main (argc=2, argv=0x7ffd23d81878) at gdb_test.c:8
8           if (strcmp(argv[1], p) == 0)
(gdb) print argv[1]
$1 = 0x7ffd23d82067 "hello"
(gdb) print p
$2 = 0x55ebd9fc5008 "PentesterAcademyPass"
(gdb) set variable p = argv[1]
(gdb) print p
$3 = 0x7ffd23d82067 "hello"
(gdb) c
Continuing.

Welcome to the SLAE 64-bit course! Please proceed to the next video!
[Inferior 1 (process 14885) exited normally]

Reading symbols from gdb_test...
(gdb) disassemble main

GENERAL PURPOSE REGISTER:
$ nasm -felf64 HelloWorld.nasm -o HelloWorld.o
$ ld HelloWorld.o -o HelloWorld 

REDUZE INSTRUCTION SIZE 
REMOVE NULLS
$ cp HelloWorld.nasm HelloWorld-small.nasm

$ objdump -M intel -d HelloWorld
 401000:       b8 01 00 00 00          mov    eax,0x1 

$ nasm -f elf64 HelloWorld-small.nasm -o HelloWorld-small.o
$ ld HelloWorld-small.o -o HelloWorld-small

$ objdump -M intel -d HelloWorld-small.o
 0:   b0 01                   mov    al,0x1

 SAFE MODE:
 $ cp HelloWorld.nasm HelloWorld-shellcodesafe.nasm
 MUDOU ISTO:
 _start:

	;print on screen
	xor rax,	rax
	mov al,		1

$ nasm -f elf64 HelloWorld-shellcodesafe.nasm -o HelloWorld-shellcodesafe.o
$ ld HelloWorld-shellcodesafe.o -o HelloWorld-shellcodesafe

$ objdump -M intel -d HelloWorld-shellcodesafe
0000000000401000 <_start>:
  401000:       48 31 c0                xor    rax,rax
  401003:       b0 01                   mov    al,0x1
 
 

SPCIAL TOKENS:
$ - Evaluates for current line
$$ - Evaluate for beginning of current section

$ nasm -f elf64 DataTypes.nasm -o DataTypes.o
$ ld DataTypes.o -o DataTypes

$ gdb ./DataTypes -q
(gdb) set disassembly-flavor intel
(gdb) break _start
Breakpoint 1 at 0x401000
(gdb) run
(gdb) disassemble
(gdb) info variables
All defined variables:
0x0000000000402000  hello_world
0x0000000000402022  var1
0x0000000000402024  var2
0x0000000000402026  var3
0x000000000040202a  var4
0x0000000000402032  repeat_buffer
0x00000000004020b2  __bss_start
0x00000000004020b2  _edata
0x00000000004020b4  buffer
0x00000000004020f8  _end
(gdb) 

(gdb) x/2xb &var1
0x402022:       0x11    0x22
(gdb) x/xh &var2
0x402024:       0x3344
(gdb) x/xw &var3
0x402026:       0xaabbccdd
(gdb) 
0x40202a:       0x11223344
(gdb) 
0x40202e:       0xaabbccdd
(gdb) 
0x402032:       0xaaaaaaaa
(gdb) x/xg &var4
0x40202a:       0xaabbccdd11223344
(gdb) x/128xb &repeat_buffer
0x402032:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x40203a:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x402042:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x40204a:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x402052:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x40205a:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x402062:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x40206a:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x402072:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x40207a:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x402082:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x40208a:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x402092:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x40209a:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x4020a2:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa
0x4020aa:       0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa    0xaa

(gdb) x/64xb &buffer
0x4020b4:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x4020bc:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x4020c4:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x4020cc:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x4020d4:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x4020dc:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x4020e4:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00
0x4020ec:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00

IMPORTANTE 1:25:20  Até   1:34:37
####################################################################################

ENDIANES:
$ nasm -felf64 Endian.nasm -o Endian.o
$ ld -o Endian Endian.o

gitpod /workspace/kernel/pentesteracadem (main) $ ./Endian 
Hello World to the SLAE-64 Course
gitpod /workspace/kernel/pentesteracadem (main) $ gdb -q ./Endian
Reading symbols from ./Endian...
(No debugging symbols found in ./Endian)
(gdb) set disassembly-flavor intel
(gdb) break _start
Breakpoint 1 at 0x401000
(gdb) run
Starting program: /workspace/kernel/pentesteracadem/Endian 
warning: Error disabling address space randomization: Operation not permitted

Breakpoint 1, 0x0000000000401000 in _start ()
(gdb) disassemble
Dump of assembler code for function _start:
=> 0x0000000000401000 <+0>:     mov    eax,0x1
   0x0000000000401005 <+5>:     mov    edi,0x1
   0x000000000040100a <+10>:    movabs rsi,0x402000
   0x0000000000401014 <+20>:    mov    edx,0x22
   0x0000000000401019 <+25>:    syscall 
   0x000000000040101b <+27>:    mov    rax,QWORD PTR ds:0x402022
   0x0000000000401023 <+35>:    mov    rbx,QWORD PTR ds:0x40202a
   0x000000000040102b <+43>:    mov    eax,0x3c
   0x0000000000401030 <+48>:    mov    edi,0xb
   0x0000000000401035 <+53>:    syscall 
End of assembler dump.
(gdb) info variables
All defined variables:

Non-debugging symbols:
0x0000000000402000  hello_world
0x0000000000402022  var1
0x000000000040202a  var2
0x0000000000402032  __bss_start
0x0000000000402032  _edata
0x0000000000402038  _end
(gdb) help x
Examine memory: x/FMT ADDRESS.
ADDRESS is an expression for the memory address to examine.
FMT is a repeat count followed by a format letter and a size letter.
Format letters are o(octal), x(hex), d(decimal), u(unsigned decimal),
  t(binary), f(float), a(address), i(instruction), c(char), s(string)
  and z(hex, zero padded on the left).
Size letters are b(byte), h(halfword), w(word), g(giant, 8 bytes).
The specified number of objects of the specified size are printed
according to the format.  If a negative number is specified, memory is
examined backward from the address.

Defaults for format and size letters are those previously used.
Default count is 1.  Default address is following last thing printed
with this command or "print".
(gdb) x/8xb &var1
0x402022:       0x11    0x22    0x33    0x44    0x55    0x66    0x77    0x88
(gdb) x/8h &var1
0x402022:       0x2211  0x4433  0x6655  0x8877  0x7788  0x5566  0x3344  0x1122
(gdb) x/xh &var1
0x402022:       0x2211
(gdb) x/xw &var1
0x402022:       0x44332211
(gdb) x/xg &var1
0x402022:       0x8877665544332211
(gdb) x/xg &var2
0x40202a:       0x1122334455667788
(gdb) disassemble
Dump of assembler code for function _start:
=> 0x0000000000401000 <+0>:     mov    eax,0x1
   0x0000000000401005 <+5>:     mov    edi,0x1
   0x000000000040100a <+10>:    movabs rsi,0x402000
   0x0000000000401014 <+20>:    mov    edx,0x22
   0x0000000000401019 <+25>:    syscall 
   0x000000000040101b <+27>:    mov    rax,QWORD PTR ds:0x402022
   0x0000000000401023 <+35>:    mov    rbx,QWORD PTR ds:0x40202a
   0x000000000040102b <+43>:    mov    eax,0x3c
   0x0000000000401030 <+48>:    mov    edi,0xb
   0x0000000000401035 <+53>:    syscall 
End of assembler dump.
(gdb) break *rip+27
No symbol table is loaded.  Use the "file" command.
(gdb) break *$rip+27
Breakpoint 2 at 0x40101b
(gdb) c
Continuing.
Hello World to the SLAE-64 Course

Breakpoint 2, 0x000000000040101b in _start ()
(gdb) disassemble
Dump of assembler code for function _start:
   0x0000000000401000 <+0>:     mov    eax,0x1
   0x0000000000401005 <+5>:     mov    edi,0x1
   0x000000000040100a <+10>:    movabs rsi,0x402000
   0x0000000000401014 <+20>:    mov    edx,0x22
   0x0000000000401019 <+25>:    syscall 
=> 0x000000000040101b <+27>:    mov    rax,QWORD PTR ds:0x402022
   0x0000000000401023 <+35>:    mov    rbx,QWORD PTR ds:0x40202a
   0x000000000040102b <+43>:    mov    eax,0x3c
   0x0000000000401030 <+48>:    mov    edi,0xb
   0x0000000000401035 <+53>:    syscall 
End of assembler dump.
(gdb) info registers
rax            0x22                34
rbx            0x0                 0
rcx            0x40101b            4198427
rdx            0x22                34
rsi            0x402000            4202496
rdi            0x1                 1
rbp            0x0                 0x0
rsp            0x7fff01d7ab90      0x7fff01d7ab90
r8             0x0                 0
r9             0x0                 0
r10            0x0                 0
r11            0x202               514
r12            0x0                 0
r13            0x0                 0
r14            0x0                 0
r15            0x0                 0
rip            0x40101b            0x40101b <_start+27>
eflags         0x202               [ IF ]
cs             0x33                51
ss             0x2b                43
ds             0x0                 0
es             0x0                 0
fs             0x0                 0
gs             0x0                 0
(gdb) nexti
0x0000000000401023 in _start ()
(gdb) disassemble
Dump of assembler code for function _start:
   0x0000000000401000 <+0>:     mov    eax,0x1
   0x0000000000401005 <+5>:     mov    edi,0x1
   0x000000000040100a <+10>:    movabs rsi,0x402000
   0x0000000000401014 <+20>:    mov    edx,0x22
   0x0000000000401019 <+25>:    syscall 
   0x000000000040101b <+27>:    mov    rax,QWORD PTR ds:0x402022
=> 0x0000000000401023 <+35>:    mov    rbx,QWORD PTR ds:0x40202a
   0x000000000040102b <+43>:    mov    eax,0x3c
   0x0000000000401030 <+48>:    mov    edi,0xb
   0x0000000000401035 <+53>:    syscall 
End of assembler dump.
(gdb) info registers
rax            0x8877665544332211  -8613303245920329199
rbx            0x0                 0
rcx            0x40101b            4198427
rdx            0x22                34
rsi            0x402000            4202496
rdi            0x1                 1
rbp            0x0                 0x0
rsp            0x7fff01d7ab90      0x7fff01d7ab90
r8             0x0                 0
r9             0x0                 0
r10            0x0                 0
r11            0x202               514
r12            0x0                 0
r13            0x0                 0
r14            0x0                 0
r15            0x0                 0
rip            0x401023            0x401023 <_start+35>
eflags         0x202               [ IF ]
cs             0x33                51
ss             0x2b                43
ds             0x0                 0
es             0x0                 0
fs             0x0                 0
gs             0x0                 0
(gdb) nexti
0x000000000040102b in _start ()
(gdb) info registers
rax            0x8877665544332211  -8613303245920329199
rbx            0x1122334455667788  1234605616436508552
rcx            0x40101b            4198427
rdx            0x22                34
rsi            0x402000            4202496
rdi            0x1                 1
rbp            0x0                 0x0
rsp            0x7fff01d7ab90      0x7fff01d7ab90
r8             0x0                 0
r9             0x0                 0
r10            0x0                 0
r11            0x202               514
r12            0x0                 0
r13            0x0                 0
r14            0x0                 0
r15            0x0                 0
rip            0x40102b            0x40102b <_start+43>
eflags         0x202               [ IF ]
cs             0x33                51
ss             0x2b                43
ds             0x0                 0
es             0x0                 0
fs             0x0                 0
gs             0x0                 0
(gdb) 


COMPILAÇÃO PROFISSIONAL:
Oficial : https://www.gnu.org/software/make/manual/make.html

echo 		@echo "Ola Mundo! :)"  --> Uma exibição silenciosa, não exibe o comando
só exibe a saida

$ make -n --> para ver as variaveis que vão ser executadas, sem executar o programa

VER PROCESSOS NO COMPUTADOR:
$ ps ux
INTEL MANUALS:
https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html

$ gdb ./gdb_test 
(gdb) set disassembly-flavor intel
(gdb) disassemble main

PROGRAMMING ASSEMBLY:
http://nasm.us
OPÇÕES AT&T AND INTEL SINTAX

SYSCALL LINUX KERNEL TABLE , RESEARCH

INVOKING SYSTEM CALL WITH SYSCALL:
RAX - System Call Number
RDI - 1st Argument
RSI - 2nd Argument
RDX - 3rd Argument
R10 - 4th Argument
R8  - 5th Argument
R9  - 6th Argument


